(function(g,o,a,T,N,c,P,D,U,R,m,C,I,v){"use strict";function B(e,r,u,t){let n=Math.abs(e);return n%=100,n>=5&&n<=20?t:(n%=10,n===1?r:n>=2&&n<=4?u:t)}function w(e,r,u){return e===1?r:u}let f={};f={settings:{titles:{settings:{"en-GB":"Settings",uk:"\u041D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F",ru:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438"},filters:{"en-GB":"Filters",uk:"\u0424\u0456\u043B\u044C\u0442\u0440\u0438",ru:"\u0424\u0438\u043B\u044C\u0442\u0440\u044B"}},showTimestamps:{"en-GB":"Show the time of deletion",uk:"\u041F\u043E\u043A\u0430\u0437\u0443\u0432\u0430\u0442\u0438 \u0447\u0430\u0441 \u0432\u0438\u0434\u0430\u043B\u0435\u043D\u043D\u044F",ru:"\u041F\u043E\u043A\u0430\u0437\u044B\u0432\u0430\u0442\u044C \u0432\u0440\u0435\u043C\u044F \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F"},ewTimestampFormat:{"en-GB":"Use 12-hour format",uk:"\u0412\u0438\u043A\u043E\u0440\u0438\u0441\u0442\u043E\u0432\u0443\u0432\u0430\u0442\u0438 12-\u0433\u043E\u0434\u0438\u043D\u043D\u0438\u0439 \u0444\u043E\u0440\u043C\u0430\u0442",ru:"\u0418\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u044C 12-\u0447\u0430\u0441\u043E\u0432\u043E\u0439 \u0444\u043E\u0440\u043C\u0430\u0442"},youDeletedItWarning:{"en-GB":"The messages YOU deleted - are not saved",uk:"\u041F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u043D\u044F \u044F\u043A\u0456 \u0432\u0438\u0434\u0430\u043B\u0438\u043B\u0438 \u0412\u0418 - \u043D\u0435 \u0437\u0431\u0435\u0440\u0456\u0433\u0430\u044E\u0442\u0441\u044F",ru:"\u0421\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F \u0443\u0434\u0430\u043B\u0435\u043D\u043D\u044B\u0435 \u0412\u0410\u041C\u0418 - \u043D\u0435 \u0441\u043E\u0445\u0440\u0430\u043D\u044F\u044E\u0442\u0441\u044F"},addUsersInfo:{"en-GB":function(){return`To add or remove users from the ignore list, follow these steps:
1. open their profile
2. press the \u2022\u2022\u2022
3. press "${f.optionLabels[0]["en-GB"]}"
4. \u{1F389}`},uk:function(){return`\u0429\u043E\u0431 \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u0438 \u043A\u043E\u0433\u043E\u0441\u044C \u0434\u043E \u0441\u043F\u0438\u0441\u043A\u0443 \u0456\u0433\u043D\u043E\u0440\u043E\u0432\u0430\u043D\u0438\u0445 \u043A\u043E\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447\u0456\u0432, \u0432\u0438\u043A\u043E\u043D\u0430\u0439\u0442\u0435 \u0446\u0456 \u0434\u0456\u0457:
1. \u0432\u0456\u0434\u043A\u0440\u0438\u0442\u0435 \u0457\u0445 \u043F\u0440\u043E\u0444\u0456\u043B\u044C
2. \u043D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C \u2022\u2022\u2022
3. \u043D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C "${f.optionLabels[0].uk}"
4. \u{1F389}`},ru:function(){return`\u0427\u0442\u043E\u0431\u044B \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043A\u043E\u0433\u043E-\u0442\u043E \u0432 \u0441\u043F\u0438\u0441\u043E\u043A \u0438\u0433\u043D\u043E\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0445 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439 - \u0441\u043B\u0435\u0434\u0443\u0439\u0442\u0435 \u044D\u0442\u0438\u043C \u0448\u0430\u0433\u0430\u043C
1. \u043E\u0442\u043A\u0440\u043E\u0439\u0442\u0435 \u0438\u0445 \u043F\u0440\u043E\u0444\u0438\u043B\u044C
2. \u043D\u0430\u0436\u043C\u0438\u0442\u0435 \u2022\u2022\u2022
3. \u043D\u0430\u0436\u043C\u0438\u0442\u0435 "${f.optionLabels[0].ru}"
4. \u{1F389}`}},ignoreBots:{"en-GB":"Ignore bots",uk:"\u0406\u0433\u043D\u043E\u0440\u0443\u0432\u0430\u0442\u0438 \u0431\u043E\u0442\u0456\u0432",ru:"\u0418\u0433\u043D\u043E\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0431\u043E\u0442\u043E\u0432"},clearUsersLabel:{"en-GB":function(e){return`You have ${e} user${w(e,"","s")} in the ignored users list`},uk:function(e){return`\u0412\u0438 \u043C\u0430\u0454\u0442\u0435 ${e} \u043A\u043E\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447${B(e,"\u0430","\u0430","\u0456\u0432")} \u0443 \u0441\u043F\u0438\u0441\u043A\u0443 \u0456\u0433\u043D\u043E\u0440\u043E\u0432\u0430\u043D\u0438\u0445 \u043A\u043E\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447\u0456\u0432`},ru:function(e){return`\u0412\u044B \u0438\u043C\u0435\u0435\u0442\u0435 ${e} \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B${B(e,"\u044F","\u044F","\u0435\u0439")} \u0432 \u0441\u043F\u0438\u0441\u043A\u0435 \u0438\u0433\u043D\u043E\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0445 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439`}},confirmClear:{title:{"en-GB":"Hold on!",uk:"\u041F\u043E\u0447\u0435\u043A\u0430\u0439-\u043D\u043E!",ru:"\u041F\u043E\u043B\u043E\u0436\u0434\u0438-\u043A\u0430!"},description:{"en-GB":function(e){return`This will remove ${e} user${w(e,"","s")} from the ignored users list.
Do you you really want to do that?`},uk:function(e){return`\u0426\u0435 \u043F\u0440\u0438\u0431\u0435\u0440\u0435 ${e} \u043A\u043E\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447${B(e,"\u0430","\u0430","\u0456\u0432")} \u0437\u0456 \u0441\u043F\u0438\u0441\u043A\u0443 \u0456\u0433\u043D\u043E\u0440\u043E\u0432\u0430\u043D\u0438\u0445 \u043A\u043E\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447\u0456\u0432.
\u0412\u0438 \u0434\u0456\u0439\u0441\u043D\u043E \u0445\u043E\u0447\u0435\u0442\u0435 \u043F\u0440\u043E\u0434\u043E\u0432\u0436\u0438\u0442\u0438?`},ru:function(e){return`\u042D\u0442\u043E \u0443\u0431\u0435\u0440\u0435\u0442 ${e} \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B${B(e,"\u044F","\u044F","\u0435\u0439")} \u0438\u0437 \u0441\u043F\u0438\u0441\u043A\u0430 \u0438\u0433\u043D\u043E\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0445 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439.
\u0412\u044B \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C?`}},yes:{"en-GB":"Yes",uk:"\u0422\u0430\u043A",ru:"\u0414\u0430"},no:{"en-GB":"Cancel",uk:"\u0412\u0456\u0434\u043C\u0438\u043D\u0438\u0442\u0438",ru:"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C"}},removeUserButton:{"en-GB":"REMOVE",uk:"\u041F\u0420\u0418\u0411\u0420\u0410\u0422\u0418",ru:"\u0423\u0411\u0420\u0410\u0422\u042C"}},optionLabels:[{"en-GB":"Add to NoDelete ignored users list",uk:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u0438 \u0434\u043E \u0441\u043F\u0438\u0441\u043A\u0443 \u0456\u0433\u043D\u043E\u0440\u043E\u0432\u0430\u043D\u0438\u0445 \u043A\u043E\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447\u0456\u0432 \u0443 NoDelete",ru:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0432 \u0441\u043F\u0438\u0441\u043E\u043A \u0438\u0433\u043D\u043E\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0445 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439 \u0432 NoDelete"},{"en-GB":"Remove from the NoDelete ignore list",uk:"\u041F\u0440\u0438\u0431\u0440\u0430\u0442\u0438 \u0437 \u0441\u043F\u0438\u0441\u043A\u0443 \u0456\u0433\u043D\u043E\u0440\u043E\u0432\u0430\u043D\u0438\u0445 \u043A\u043E\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447\u0456\u0432 \u0443 NoDelete",ru:"\u0423\u0431\u0440\u0430\u0442\u044C \u0438\u0437 \u0441\u043F\u0438\u0441\u043A\u0430 \u0438\u0433\u043D\u043E\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0445 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439 \u0432 NoDelete"}],toastLabels:[{"en-GB":"Added ${user} to the ignored users list",uk:"${user} \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u043E \u0434\u043E \u0441\u043F\u0438\u0441\u043A\u0443 \u0456\u0433\u043D\u043E\u0440\u043E\u0432\u0430\u043D\u0438\u0445 \u043A\u043E\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447\u0456\u0432",ru:"${user} \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u044B \u0432 \u0441\u043F\u0438\u0441\u043E\u043A \u0438\u0433\u043D\u043E\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0445 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439"},{"en-GB":"Removed ${user} from the ignored users list",uk:"${user} \u043F\u0440\u0438\u0431\u0440\u0430\u043D\u043E \u0437\u0456 \u0441\u043F\u0438\u0441\u043A\u0443 \u0456\u0433\u043D\u043E\u0440\u043E\u0432\u0430\u043D\u0438\u0445 \u043A\u043E\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447\u0456\u0432",ru:"${user} \u0443\u0431\u0440\u0430\u043D\u044B \u0438\u0437 \u0441\u043F\u0438\u0441\u043A\u0430 \u0438\u0433\u043D\u043E\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0445 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439"}],thisMessageWasDeleted:{"en-GB":"This message was deleted",uk:"\u0426\u0435 \u043F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u043D\u044F \u0431\u0443\u043B\u043E \u0432\u0438\u0434\u0430\u043B\u0435\u043D\u043E",ru:"\u042D\u0442\u043E \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435 \u0431\u044B\u043B\u043E \u0443\u0434\u0430\u043B\u0435\u043D\u043E"},deleted:{"en-GB":"deleted",uk:"\u0432\u0438\u0434\u0430\u043B\u0435\u043D\u043E",ru:"\u0443\u0434\u0430\u043B\u0435\u043D\u043E"}};const G=function(){return vendetta.metro.findByStoreName("LocaleStore").locale},L="en-GB";function i(e,r){let u=f;for(const n of e.split("."))u?.hasOwnProperty(n)?u=u[n]:u=f;if(u===f)return e;let t=u[G()]??u[L]??e;return typeof t=="function"&&!r&&(t=t()),r?{make:t}:t}const F=U.createThemedStyleSheet({container:{flexDirection:"row",alignItems:"center"},image:{marginLeft:5,marginRight:5,width:25,height:25,borderRadius:100},label:{color:R.semanticColors.HEADER_PRIMARY},labelRemove:{color:R.semanticColors.TEXT_WARNING}});function _({imageSource:e,onImagePress:r,label:u,labelRemove:t="REMOVE",onRemove:n}){return React.createElement(React.Fragment,null,React.createElement(D.View,{style:F.container},React.createElement(D.TouchableOpacity,{onPress:n},React.createElement(D.Text,{style:F.labelRemove},t)),React.createElement(D.TouchableOpacity,{onPress:r},React.createElement(D.Image,{style:[F.image],source:e})),React.createElement(D.Text,{style:F.label},u)))}let y,$,k;function M(e){y??=m.findByStoreName("UserStore"),$??=m.findByProps("fetchProfile","getUser","setFlag"),k??=m.findByProps("showUserProfile");async function r(s){const E=k.showUserProfile;y.getUser(s)?E({userId:s}):$.getUser(s).then(function({id:h}){return E({userId:h})})}T.useProxy(a.storage);const[u,t]=o.React.useState(a.storage.ignore.users),n=function(s){const E=u.filter(function(h){return h!==s});a.storage.ignore.users=E,t(E)},d=function(){a.storage.ignore.users=[],t([])};let l=0;return o.React.createElement(o.ReactNative.ScrollView,{style:{flex:1}},o.React.createElement(c.Forms.FormSection,{title:i("settings.titles.settings"),titleStyleType:"no_border"},o.React.createElement(c.Forms.FormRow,{label:i("settings.showTimestamps"),trailing:o.React.createElement(c.Forms.FormSwitch,{value:a.storage.timestamps,onValueChange:function(s){return a.storage.timestamps=s}})}),o.React.createElement(c.Forms.FormRow,{label:i("settings.ewTimestampFormat"),trailing:o.React.createElement(c.Forms.FormSwitch,{value:a.storage.ew,onValueChange:function(s){return a.storage.ew=s}})}),o.React.createElement(c.Forms.FormDivider,null),o.React.createElement(c.Forms.FormRow,{label:i("settings.youDeletedItWarning")})),o.React.createElement(c.Forms.FormSection,{title:i("settings.titles.filters")},o.React.createElement(c.Forms.FormRow,{label:i("settings.ignoreBots"),trailing:o.React.createElement(c.Forms.FormSwitch,{value:a.storage.ignore.bots,onValueChange:function(s){return a.storage.ignore.bots=s}})}),o.React.createElement(c.Forms.FormRow,{label:i("settings.clearUsersLabel",!0)?.make?.(u.length),trailing:o.React.createElement(c.Forms.FormRow.Icon,{source:P.getAssetIDByName("ic_trash_24px")}),onPress:function(){u.length!==0&&N.showConfirmationAlert({title:i("settings.confirmClear.title"),content:i("settings.confirmClear.description",!0)?.make?.(u.length),confirmText:i("settings.confirmClear.yes"),cancelText:i("settings.confirmClear.no"),confirmColor:"brand",onConfirm:d})}}),o.React.createElement(o.ReactNative.ScrollView,{style:{flex:1,gap:3,marginLeft:15}},u.map(function(s){const E=y.getUser(s)??{};let h=E?.getAvatarURL?.(null,26)?.replace?.(/\.(gif|webp)/,".png");return h||(h="https://cdn.discordapp.com/embed/avatars/1.png?size=48",E.username=`${s} Uncached`,E.discriminator="0",l===0&&(E.username+=", press the avatar"),l++),o.React.createElement(_,{imageSource:{uri:h},onImagePress:function(){r(s)},onRemove:function(){return n(s)},label:E.username+(E.discriminator==0?"":`#${E.discriminator}`),labelRemove:i("settings.removeUserButton")})})),o.React.createElement(c.Forms.FormDivider,null),o.React.createElement(c.Forms.FormRow,{label:i("settings.addUsersInfo")})))}function S(e,r){if(e===void 0)throw new Error("No object passed to make defaults for");if(r===void 0)throw new Error("No defaults object passed to make defaults off of");for(const u in r)typeof r[u]=="object"&&!Array.isArray(r[u])?(typeof e[u]!="object"&&(e[u]={}),S(e[u],r[u])):e[u]??=r[u];return e}S(a.storage,{ignore:{users:[],channels:[],bots:!1},timestamps:!1,ew:!1,onlyTimestamps:!1});let b,p=[];const A=new Set;var x={settings:M,patches:[],onUnload(){this.patches.forEach(function(e){return e()}),this.patches=[]},onLoad(){try{this.patches.push(C.before("dispatch",o.FluxDispatcher,function(r){try{b||(b=m.findByStoreName("MessageStore"));const u=r[0];if(!u||u?.type!=="MESSAGE_DELETE"||!u?.id||!u?.channelId)return;const t=b.getMessage(u.channelId,u.id);if(a.storage.ignore.users.includes(t?.author?.id)||a.storage.ignore.bots&&t?.author?.bot)return;if(p.includes(u.id))return p.splice(p.indexOf(u.id),1),r;p.push(u.id),A.add(u.id);let n=` (${i("deleted")})`;return a.storage.timestamps&&(n=` (${i("deleted")} ${o.moment().format(a.storage.ew?"hh:mm:ss a":"HH:mm:ss")})`),r[0]={type:"MESSAGE_UPDATE",message:{id:u.id,channel_id:u.channelId,content:t.content+n,guild_id:t.guild_id}},r}catch(u){console.error(u),alert(`[Nodelete \u2192 dispatcher patch] died
`+u.stack)}}));try{const r=m.findByName("MessageContent",!1);r&&this.patches.push(C.after("default",r,function(u,t){try{const n=u[0]?.message;if(!n?.id||!A.has(n.id))return;const d=function(l){l&&(l.props&&(l.props.style=[l.props.style,{color:"#f04747"}].flat().filter(Boolean)),l.props?.children&&(Array.isArray(l.props.children)?l.props.children.forEach(d):typeof l.props.children=="object"&&d(l.props.children)))};d(t)}catch(n){console.error("[NoDelete \u2192 message style patch]",n)}}))}catch(r){console.error("[NoDelete] Failed to patch message content styling:",r)}const e=C.before("render",m.findByProps("ScrollView").View,function(r){try{let u=I.findInReactTree(r,function(s){return s.key===".$UserProfileOverflow"});if(!u||!u.props||u.props.sheetKey!=="UserProfileOverflow")return;const t=u.props.content.props,n=f.optionLabels.map(Object.values).flat();if(t.options.some(function(s){return n.includes(s?.label)}))return;const d=Object.keys(u._owner.stateNode._keyChildMapping).find(function(s){return u._owner.stateNode._keyChildMapping[s]&&s.match(/(?<=\$UserProfile)\d+/)})?.slice?.(13);let l=t.options.findLastIndex(function(s){return s.isDestructive});a.storage.ignore.users.includes(d)?t.options.splice(l+1,0,{label:i("optionLabels.1"),onPress:function(){a.storage.ignore.users.splice(a.storage.ignore.users.findIndex(function(s){return s===d}),1),v.showToast(i("toastLabels.1").replaceAll("${user}",t.header.title)),t.hideActionSheet()}}):t.options.splice(l+1,0,{isDestructive:!0,label:i("optionLabels.0"),onPress:function(){a.storage.ignore.users.push(d),v.showToast(i("toastLabels.0").replaceAll("${user}",t.header.title)),t.hideActionSheet()}})}catch(u){console.error(u);let t=!1;try{t=e()}catch{t=!1}alert(`[NoDelete \u2192 context menu patch] failed. Patch ${t?"dis":"en"}abled
`+u.stack)}});this.patches.push(e)}catch(e){console.error(e),alert(`[NoDelete] dead
`+e.stack)}}};return g.default=x,g.deletedMessages=A,Object.defineProperty(g,"__esModule",{value:!0}),g})({},vendetta.metro.common,vendetta.plugin,vendetta.storage,vendetta.ui.alerts,vendetta.ui.components,vendetta.ui.assets,vendetta.ui.components.General,vendetta.metro.common.stylesheet,vendetta.ui,vendetta.metro,vendetta.patcher,vendetta.utils,vendetta.ui.toasts);
